#THIS IS THE CORRECT CODE FOR LAGGED VARIABLE

new_dfs = []
for i in df['RSSD ID'].unique():
  new_df_i = df.loc[df['RSSD ID']==i,:]
  new_df_i = new_df_i.sort_values(['Year', 'Quarter'])
  new_df_i["Lagged Income"] = new_df_i['Normalized Interest Income per Quarter'].shift(1)
  new_dfs.append(new_df_i)

df_lag = pd.concat(new_dfs, ignore_index=True)
df_lag.head()
